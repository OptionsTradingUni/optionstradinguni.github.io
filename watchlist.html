<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Watchlist - Options Trading University</title>
  <style>
    :root {
      --blue:#2a7fff; --pink:#ff4081; --ink:#0f1a33;
      --panel:#ffffff; --page:#f4f7ff; --line:#e3e9f2;
      --nav:#0b1328; --muted:#7e89a6; --good:#0a8a4a;
      --good-bg:#d4f5e9; --bad:#c62828; --bad-bg:#ffdada;
    }
    *{box-sizing:border-box;}
    body{margin:0;font-family:sans-serif;background:var(--page);color:var(--ink);}
    a{text-decoration:none;color:inherit;}

    .sidebar{position:fixed;top:0;left:0;bottom:0;width:220px;background:var(--nav);color:#fff;padding-top:10px;z-index:1000;}
    .brand{display:flex;align-items:center;gap:10px;padding:10px;}
    .brand-logo{width:30px;height:30px;border-radius:6px;object-fit:cover;}
    .brand span{font-weight:900;background:linear-gradient(90deg,var(--blue),var(--pink));-webkit-background-clip:text;-webkit-text-fill-color:transparent;}
    .side-nav{display:flex;flex-direction:column;padding:10px;gap:5px;}
    .side-nav a{color:#d8e2ff;padding:8px;border-radius:6px;font-weight:600;}
    .side-nav a.active{background:#163067;}

    .page{margin-left:220px;min-height:100vh;display:flex;flex-direction:column;}
    .topbar{background:#fff;border-bottom:1px solid var(--line);display:flex;justify-content:space-between;align-items:center;padding:10px;}
    .brand-inline{font-weight:900;background:linear-gradient(90deg,var(--blue),var(--pink));-webkit-background-clip:text;-webkit-text-fill-color:transparent;}
    .burger{display:none;font-size:20px;background:none;border:none;cursor:pointer;}
    .btn{background:var(--blue);color:#fff;border:none;border-radius:6px;padding:8px 14px;cursor:pointer;font-weight:600; text-decoration: none;}

    .container{max-width:1200px;margin:0 auto;padding:20px;}

    .watchlist{display:grid;grid-template-columns:repeat(auto-fit,minmax(280px,1fr));gap:18px;}
    .stock-card{background:var(--panel);border:1px solid var(--line);border-radius:12px;padding:16px;box-shadow:0 2px 6px rgba(0,0,0,.05);}
    .stock-header{display:flex;align-items:center;justify-content:space-between;}
    .logo{width:50px;height:50px;object-fit:contain;border-radius:6px;background:#fff;border:1px solid var(--line);}
    .symbol{font-size:18px;font-weight:800;color:var(--blue);}
    .price{font-size:20px;font-weight:900;}
    .change{font-size:13px;padding:3px 8px;border-radius:6px;font-weight:700;}
    .change.up{background:var(--good-bg);color:var(--good);}
    .change.down{background:var(--bad-bg);color:var(--bad);}
    .news{margin-top:10px;font-size:13px;color:var(--muted);}
    .news a{display:block;margin-bottom:4px;color:var(--ink);font-weight:600;}

    .footer{margin-top:auto;background:var(--nav);color:#9cb2ff;text-align:center;padding:12px;}
    
    .modal-backdrop{position:fixed;inset:0;background:rgba(0,0,0,.6);display:none;align-items:center;justify-content:center;z-index:2000;}
    .modal{background:#fff;border-radius:10px;padding:20px;max-width:400px;width:90%;}
    .modal .close{float:right;border:none;background:none;font-size:20px;cursor:pointer;}
    .contact-options{display:flex;flex-direction:column;gap:10px;margin-top:15px;}
    .contact-options .btn{display:block;text-align:center;color:#fff;padding:12px;}
    .contact-options .btn.telegram{background:#0088cc;}
    .contact-options .btn.tiktok{background:#25f4ee;color:#000;}
    #tiktok-info{display:none;margin-top:15px;border-top:1px solid #eee;padding-top:15px;}
    .suggest{background:#f5f9ff;padding:10px;border-radius:6px;font-family:monospace;}

    .btn[disabled] {
        background: #aaa !important;
        cursor: not-allowed !important;
    }

    @media(max-width:768px){.sidebar{display:none;}.page{margin-left:0;}.burger{display:block;}}
  </style>
</head>
<body>
  <aside class="sidebar" id="sidebar">
    <div class="brand"><img src="branding/logo.jpeg" class="brand-logo"><span>OTU</span></div>
    <nav class="side-nav">
      <a href="index.html">Home</a><a href="watchlist.html" class="active">Watchlist</a>
      <a href="modules.html">Modules</a><a href="glossary.html">Glossary</a>
      <a href="testimonials.html">Testimonials</a><a href="contact.html">Contact</a>
      <a href="terms.html">Disclaimer</a>
    </nav>
  </aside>

  <div class="page">
    <header class="topbar">
      <button class="burger" id="burger">‚ò∞</button>
      <div class="brand-inline">Options Trading University</div>
      <button class="btn" onclick="openContactModal()">Message a Mentor</button>
    </header>

    <main class="container">
      <h1 style="color:var(--blue)">üìä Live Watchlist</h1>
      <div id="watchlist" class="watchlist"></div>
      <p id="error" style="display:none;color:red;">‚ö†Ô∏è Temporary data issue. Please retry shortly.</p>
    </main>

    <footer class="footer">¬© 2025 Options Trading University</footer>
  </div>

  <div class="modal-backdrop" id="contact-modal">
    <div class="modal">
      <button class="close" onclick="closeContactModal()">‚úï</button>
      <h3 style="color:var(--blue)">Contact a Mentor</h3>
      <p>Choose your preferred platform to get in touch.</p>
      <div class="contact-options">
        <button id="telegram-link-btn" data-link="https://t.me/thewealthprince0" class="btn telegram">Message on Telegram</button>
        <button class="btn tiktok" onclick="toggleTikTokInfo()">Message on TikTok</button>
      </div>
      <div id="tiktok-info">
        <p>Send us a DM with this message:</p>
        <div class="suggest">Hi ‚Äî I found OTU. I'd like to connect with a mentor and get started. ‚Äî <i>Your name</i></div>
      </div>
    </div>
  </div>

  <script>
    // --- ‚úÖ NEW TIKTOK DETECTION LOGIC ---
    const telegramLinkBtn = document.getElementById('telegram-link-btn');
    const isTikTok = navigator.userAgent.includes("TikTok");

    if (isTikTok) {
      telegramLinkBtn.disabled = true;
    }

    telegramLinkBtn.addEventListener('click', () => {
      if (!telegramLinkBtn.disabled) {
        window.open(telegramLinkBtn.dataset.link, '_blank');
      }
    });
    // --- END NEW LOGIC ---

    // Sidebar and Modal controls
    const burger=document.getElementById('burger');
    const sidebar=document.getElementById('sidebar');
    burger.addEventListener('click',()=> sidebar.style.display=sidebar.style.display==='block'?'none':'block');
    function openContactModal(){document.getElementById('contact-modal').style.display='flex';}
    function closeContactModal(){
      document.getElementById('contact-modal').style.display='none';
      document.getElementById('tiktok-info').style.display='none';
    }
    function toggleTikTokInfo(){
      const info=document.getElementById('tiktok-info');
      info.style.display=info.style.display==='block'?'none':'block';
    }

    // Watchlist logic
    const symbols=["AAPL","TSLA","MSFT","AMZN","NVDA"];
    const FINNHUB_KEY="d38hegpr01qlbdj5i6h0d38hegpr01qlbdj5i6hg";
    const list=document.getElementById("watchlist");
    const error=document.getElementById("error");

    async function getJson(url){
      const res=await fetch(url);
      if(!res.ok) throw new Error(res.status);
      return res.json();
    }

    async function loadSymbol(sym){
      try{
        const [quote,profile,news]=await Promise.all([
          getJson(`https://finnhub.io/api/v1/quote?symbol=${sym}&token=${FINNHUB_KEY}`),
          getJson(`https://finnhub.io/api/v1/stock/profile2?symbol=${sym}&token=${FINNHUB_KEY}`),
          getJson(`https://finnhub.io/api/v1/company-news?symbol=${sym}&from=2024-09-01&to=2025-09-22&token=${FINNHUB_KEY}`)
        ]);

        const card=document.createElement("div");
        card.className="stock-card";
        card.innerHTML=`
          <div class="stock-header">
            <img src="${profile.logo||'branding/logo.jpeg'}" class="logo" alt="${sym} logo">
            <div style="text-align:right">
              <div class="symbol">${sym}</div>
              <div class="price">$${(quote.c||0).toFixed(2)}</div>
              <div class="change ${(quote.dp||0)>=0?'up':'down'}">${quote.dp?.toFixed(2)||0}%</div>
            </div>
          </div>
          <div class="news">
            ${(news||[]).slice(0,2).map(n=>`<a href="${n.url}" target="_blank">${n.headline}</a>`).join('')}
          </div>
        `;
        list.appendChild(card);
      }catch(e){console.error(e);error.style.display="block";}
    }

    async function loadAll(){
      list.innerHTML="";
      for(const sym of symbols){await loadSymbol(sym);}
    }
    loadAll();
  </script>
</body>
</html>
